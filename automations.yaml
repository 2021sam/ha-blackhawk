- id: '1762596176562'
  alias: PIR → Man Cave Lights (until PIR clears)
  description: ''
  triggers:
  - trigger: state
    entity_id: binary_sensor.sonoff_1_occupancy
    to: 'on'
  actions:
  - data:
      reason: Motion in the atrium
    action: script.atrium_lights_on_reasoned
  - wait_for_trigger:
    - trigger: state
      entity_id: binary_sensor.sonoff_1_occupancy
      to: 'off'
    timeout: 02:00:00
    continue_on_timeout: false
  - data:
      reason: No motion for about one minute
    action: script.atrium_lights_off_reasoned
  mode: restart
- id: '1766787951743'
  alias: Front Bedroom Light auto OFF after 1 minute
  description: Single-device light auto-off test
  triggers:
  - entity_id: light.wall_dimmer_2
    to: 'on'
    trigger: state
  actions:
  - delay: 00:01:00
  - target:
      entity_id: light.wall_dimmer_2
    action: light.turn_off
  mode: restart
- id: '1767050394149'
  alias: Patio Light Bulb auto OFF after 5 minutes
  description: Single-device bulb auto-off test
  triggers:
  - entity_id: light.light_1
    to: 'on'
    trigger: state
  actions:
  - delay: 00:05:00
  - target:
      entity_id: light.light_1
    action: light.turn_off
  mode: restart
- id: '1767164503089'
  alias: TTS – Speak Google Voice last notification (title + text) - 9
  description: Speak Google Voice notifications via TTS on amp_1
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ state_attr(''sensor.lm_q710_fgn_last_notification'',''package'')
      == ''com.google.android.apps.googlevoice'' }}'
  - condition: template
    value_template: "{{\n  (state_attr('sensor.lm_q710_fgn_last_notification','android.title')
      or '')|string|length > 0\n  or\n  (state_attr('sensor.lm_q710_fgn_last_notification','android.text')
      or '')|string|length > 0\n}}"
  - condition: template
    value_template: "{{\n  (state_attr('sensor.lm_q710_fgn_last_notification','post_time')
      | string)\n  !=\n  (state_attr('sensor.lm_q710_fgn_last_notification','post_time_last_spoken')
      | string)\n}}"
  actions:
  - variables:
      n: sensor.lm_q710_fgn_last_notification
      who: '{{ (state_attr(n,''android.title'') or ''Message'') | string }}'
      txt: '{{ (state_attr(n,''android.text'') or '''') | string }}'
      msg: '{{ (who ~ '': '' ~ txt) if txt|length > 0 else (who ~ '': (no text)'')
        }}'
      pt: '{{ (state_attr(n,''post_time'') or now().timestamp()|int) }}'
  - target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: '{{ msg }}'
    action: tts.speak
  - target:
      entity_id: input_text.last_google_voice_post_time_spoken
    data:
      value: '{{ pt }}'
    action: input_text.set_value
  mode: single
- id: '1767221347387'
  alias: Deercreek - PIR → Power Strip - TTS & Soundscape
  description: Turn ON power strip when motion detected, OFF 1 min after clear. TTS
    on ON, sound on OFF.
  triggers:
  - entity_id: binary_sensor.sonoff_1_occupancy
    to: 'on'
    trigger: state
  - entity_id: binary_sensor.sonoff_1_occupancy
    to: 'off'
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.sonoff_1_occupancy
        state: 'on'
      sequence:
      - target:
          entity_id:
          - switch.power_1_switch_1
          - switch.power_1_switch_2
          - switch.power_1_switch_3
          - switch.power_1_switch_4
          - switch.power_1_switch_5
        action: switch.turn_on
      - target:
          entity_id: tts.google_translate_en_com
        data:
          media_player_entity_id: media_player.amp_1
          message: Motion detected.
        action: tts.speak
    - conditions:
      - condition: state
        entity_id: binary_sensor.sonoff_1_occupancy
        state: 'off'
      sequence:
      - delay: 00:01:00
      - condition: state
        entity_id: binary_sensor.sonoff_1_occupancy
        state: 'off'
      - target:
          entity_id: media_player.amp_1
        data:
          media:
            media_content_id: /local/soundscapes/1.wav
            media_content_type: music
            metadata: {}
        action: media_player.play_media
      - target:
          entity_id:
          - switch.power_1_switch_1
          - switch.power_1_switch_2
          - switch.power_1_switch_3
          - switch.power_1_switch_4
          - switch.power_1_switch_5
        action: switch.turn_off
  mode: restart
- id: '1767221653083'
  alias: Deercreek - PIR → Power Strip
  description: Turn ON power strip when motion detected, OFF 1 min after clear.
  triggers:
  - entity_id: binary_sensor.sonoff_1_occupancy
    to: 'on'
    trigger: state
  - entity_id: binary_sensor.sonoff_1_occupancy
    to: 'off'
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.sonoff_1_occupancy
        state: 'on'
      sequence:
      - target:
          entity_id:
          - switch.power_1_switch_1
          - switch.power_1_switch_2
          - switch.power_1_switch_3
          - switch.power_1_switch_4
          - switch.power_1_switch_5
        action: switch.turn_on
    - conditions:
      - condition: state
        entity_id: binary_sensor.sonoff_1_occupancy
        state: 'off'
      sequence:
      - delay: 00:01:00
      - condition: state
        entity_id: binary_sensor.sonoff_1_occupancy
        state: 'off'
      - target:
          entity_id:
          - switch.power_1_switch_1
          - switch.power_1_switch_2
          - switch.power_1_switch_3
          - switch.power_1_switch_4
          - switch.power_1_switch_5
        action: switch.turn_off
  mode: restart
- id: '1767252268569'
  alias: Deercreek - TTS – Speak Google Voice last notification (title + text) - Enable
  description: Speak Google Voice notifications via TTS on amp_1
  triggers:
  - entity_id: sensor.sm_g965u_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ state_attr(''sensor.sm_g965u_last_notification'',''package'')
      == ''com.google.android.apps.googlevoice'' }}'
  - condition: template
    value_template: "{{\n  (state_attr('sensor.sm_g965u_last_notification','android.title')
      or '')|string|length > 0\n  or\n  (state_attr('sensor.sm_g965u_last_notification','android.text')
      or '')|string|length > 0\n}}"
  - condition: template
    value_template: "{{\n  (state_attr('sensor.sm_g965u_last_notification','post_time')
      | string)\n  !=\n  (state_attr('sensor.sm_g965u_last_notification','post_time_last_spoken')
      | string)\n}}"
  actions:
  - variables:
      n: sensor.sm_g965u_last_notification
      who: '{{ (state_attr(n,''android.title'') or ''Message'') | string }}'
      txt: '{{ (state_attr(n,''android.text'') or '''') | string }}'
      msg: '{{ (who ~ '': '' ~ txt) if txt|length > 0 else (who ~ '': (no text)'')
        }}'
      pt: '{{ (state_attr(n,''post_time'') or now().timestamp()|int) }}'
  - target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: '{{ msg }}'
    action: tts.speak
  - target:
      entity_id: input_text.last_google_voice_post_time_spoken
    data:
      value: '{{ pt }}'
    action: input_text.set_value
  mode: single
- id: '1767258109835'
  alias: Deercreek - TTS Alert - Samsung power state changed - Enable
  description: Speak when Samsung HA phone is plugged in or unplugged
  triggers:
  - entity_id: binary_sensor.sm_g965u_is_charging
    trigger: state
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.sm_g965u_is_charging
        state: 'on'
      sequence:
      - action: tts.speak
        target:
          entity_id: tts.google_translate_en_com
        data:
          media_player_entity_id: media_player.amp_1
          message: Power restored. The Home Assistant phone is now charging.
    - conditions:
      - condition: state
        entity_id: binary_sensor.sm_g965u_is_charging
        state: 'off'
      sequence:
      - action: tts.speak
        target:
          entity_id: tts.google_translate_en_com
        data:
          media_player_entity_id: media_player.amp_1
          message: Warning. The Home Assistant phone has been unplugged.
  mode: single
- id: '1767302308327'
  alias: Deercreek - PIR → Power Strip - TTS & Soundscape - Cool Down
  description: 'Single automation version. Motion ON: lights ON, TTS only if cooldown
    idle. Motion OFF: WAV only if cooldown idle, lights OFF, cooldown starts at end.

    '
  triggers:
  - entity_id: binary_sensor.sonoff_1_occupancy
    trigger: state
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: binary_sensor.sonoff_1_occupancy
        state: 'on'
      sequence:
      - action: switch.turn_on
        target:
          entity_id:
          - switch.power_1_switch_1
          - switch.power_1_switch_2
          - switch.power_1_switch_3
          - switch.power_1_switch_4
          - switch.power_1_switch_5
      - choose:
        - conditions:
          - condition: state
            entity_id: timer.audio_cooldown
            state: idle
          sequence:
          - action: tts.speak
            target:
              entity_id: tts.google_translate_en_com
            data:
              media_player_entity_id: media_player.amp_1
              message: Motion detected.
    - conditions:
      - condition: state
        entity_id: binary_sensor.sonoff_1_occupancy
        state: 'off'
      sequence:
      - choose:
        - conditions:
          - condition: state
            entity_id: timer.audio_cooldown
            state: idle
          sequence:
          - action: media_player.play_media
            target:
              entity_id: media_player.amp_1
            data:
              media:
                media_content_id: /local/soundscapes/1.wav
                media_content_type: music
                metadata: {}
      - action: switch.turn_off
        target:
          entity_id:
          - switch.power_1_switch_1
          - switch.power_1_switch_2
          - switch.power_1_switch_3
          - switch.power_1_switch_4
          - switch.power_1_switch_5
      - action: timer.start
        target:
          entity_id: timer.audio_cooldown
  mode: restart
- id: '1767304581815'
  alias: Deercreek - TTS – Speak Google Voice last notification (title + text) - Enable
  description: Speak Google Voice notifications via TTS on amp_1
  triggers:
  - entity_id: sensor.sm_g965u_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ state_attr(n, ''package'') == ''com.google.android.apps.googlevoice''
      }}

      '
  - condition: template
    value_template: "{{\n  (state_attr(n,'android.title') or '') | length > 0\n  or\n
      \ (state_attr(n,'android.text') or '') | length > 0\n}}\n"
  - condition: template
    value_template: "{{\n  (state_attr(n,'post_time') | string)\n  !=\n  (states('input_text.last_google_voice_post_time_spoken'))\n}}\n"
  actions:
  - variables:
      who: '{{ state_attr(n,''android.title'') or ''Message'' }}'
      txt: '{{ state_attr(n,''android.text'') or '''' }}'
      msg: '{{ who ~ '': '' ~ txt if txt|length > 0 else who ~ '': (no text)'' }}'
      pt: '{{ state_attr(n,''post_time'') or now().timestamp() | int }}'
  - action: tts.speak
    target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: '{{ msg }}'
  - action: input_text.set_value
    target:
      entity_id: input_text.last_google_voice_post_time_spoken
    data:
      value: '{{ pt }}'
  mode: single
  variables:
    phone_sensor: sensor.sm_g965u_last_notification
    n: '{{ phone_sensor }}'
- id: '1767305003994'
  alias: Deercreek - TTS – Speak Google Voice last notification (Variables) - Enable
  description: Speak Google Voice notifications via TTS on amp_1
  triggers:
  - entity_id: sensor.sm_g965u_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ state_attr(n, ''package'') == ''com.google.android.apps.googlevoice''
      }}

      '
  - condition: template
    value_template: "{{\n  (state_attr(n,'android.title') or '') | length > 0\n  or\n
      \ (state_attr(n,'android.text') or '') | length > 0\n}}\n"
  - condition: template
    value_template: "{{\n  (state_attr(n,'post_time') | string)\n  !=\n  (states('input_text.last_google_voice_post_time_spoken'))\n}}\n"
  actions:
  - variables:
      who: '{{ state_attr(n,''android.title'') or ''Message'' }}'
      txt: '{{ state_attr(n,''android.text'') or '''' }}'
      msg: '{{ who ~ '': '' ~ txt if txt|length > 0 else who ~ '': (no text)'' }}'
      pt: '{{ state_attr(n,''post_time'') or now().timestamp() | int }}'
  - action: tts.speak
    target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: '{{ msg }}'
  - action: input_text.set_value
    target:
      entity_id: input_text.last_google_voice_post_time_spoken
    data:
      value: '{{ pt }}'
  mode: single
  variables:
    phone_sensor: sensor.sm_g965u_last_notification
    n: '{{ phone_sensor }}'
