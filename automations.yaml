- id: '1762596176562'
  alias: PIR → Man Cave Lights (until PIR clears)
  description: ''
  triggers:
  - trigger: state
    entity_id: binary_sensor.sonoff_1_occupancy
    to: 'on'
  actions:
  - data:
      reason: Motion in the atrium
    action: script.atrium_lights_on_reasoned
  - wait_for_trigger:
    - trigger: state
      entity_id: binary_sensor.sonoff_1_occupancy
      to: 'off'
    timeout: 02:00:00
    continue_on_timeout: false
  - data:
      reason: No motion for about one minute
    action: script.atrium_lights_off_reasoned
  mode: restart
- id: '1766787951743'
  alias: Front Bedroom Light auto OFF after 1 minute
  description: Single-device light auto-off test
  triggers:
  - entity_id: light.wall_dimmer_2
    to: 'on'
    trigger: state
  actions:
  - delay: 00:01:00
  - target:
      entity_id: light.wall_dimmer_2
    action: light.turn_off
  mode: restart
- id: '1767050394149'
  alias: Patio Light Bulb auto OFF after 5 minutes
  description: Single-device bulb auto-off test
  triggers:
  - entity_id: light.light_1
    to: 'on'
    trigger: state
  actions:
  - delay: 00:05:00
  - target:
      entity_id: light.light_1
    action: light.turn_off
  mode: restart
- id: '1767124426655'
  alias: ANDROID → Speak Notifications
  description: ''
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ trigger.to_state.attributes.text is not none }}'
  actions:
  - action: tts.speak
    target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: 'New notification from {{ trigger.to_state.attributes.package | replace(''.'',
        '' '') }}. {{ trigger.to_state.attributes.text }}

        '
  mode: queued
- id: '1767155146208'
  alias: ANDROID → Speak Notifications
  description: ''
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ trigger.to_state.attributes.text is not none }}'
  actions:
  - action: tts.speak
    target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: 'New notification from {{ trigger.to_state.attributes.package | replace(''.'',
        '' '') }}. {{ trigger.to_state.attributes.text }}

        '
  mode: queued
- id: '1767155889287'
  alias: ANDROID → Speak Notifications (Title + Text)
  description: ''
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ trigger.to_state.attributes.android is defined }}

      '
  actions:
  - target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: 'New message from {{ trigger.to_state.attributes.android.title }}.
        {{ trigger.to_state.attributes.android.text }}

        '
    action: tts.speak
  mode: queued
- id: '1767157296397'
  alias: ANDROID → Speak Notifications - 3
  description: ''
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ trigger.to_state.attributes.text is not none }}'
  actions:
  - action: tts.speak
    target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: "New notification. {{ (trigger.to_state.attributes.android.title\n
        \ if trigger.to_state.attributes.android is defined else '') }}\n{{ (trigger.to_state.attributes.android.text\n
        \ if trigger.to_state.attributes.android is defined else trigger.to_state.attributes.text)
        }}\n"
  mode: queued
- id: '1767158787584'
  alias: ANDROID → Speak Notifications (Title + Text) - 4
  description: ''
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{% set a = trigger.to_state.attributes %} {% set title = (a.android.title
      if a.android is defined else a.title) %} {% set text  = (a.android.text  if
      a.android is defined else a.text) %} {{ title is not none or text is not none
      }}

      '
  actions:
  - action: tts.speak
    target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: '{% set a = trigger.to_state.attributes %} {% set title = (a.android.title
        if a.android is defined else a.title) %} {% set text  = (a.android.text  if
        a.android is defined else a.text) %} {% if title %}{{ title }}.{% endif %}
        {% if text %} {{ text }}{% endif %}

        '
  mode: queued
- id: '1767159121196'
  alias: ANDROID → Speak Notification TEXT ONLY - 6
  description: ''
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  actions:
  - target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: '{{ trigger.to_state.attributes.android.text }}

        '
    action: tts.speak
  mode: queued
- id: '1767159337338'
  alias: ANDROID → Speak Notifications - 8 2
  description: ''
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  actions:
  - action: tts.speak
    target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: 'Android - {{ trigger.to_state.attributes.android.text }}

        '
  mode: queued
- id: '1767160241127'
  alias: ANDROID → Speak Notifications - 8 4
  description: ''
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  actions:
  - action: tts.speak
    target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: 'New Android {{ trigger.to_state.attributes.android.text }}

        '
  mode: queued
- id: '1767160809536'
  alias: ANDROID → Speak Notification TEXT (FIXED) - 9
  description: ''
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  actions:
  - target:
      entity_id: media_player.amp_1
    data:
      is_volume_muted: false
    action: media_player.volume_mute
  - target:
      entity_id: media_player.amp_1
    data:
      volume_level: 0.6
    action: media_player.volume_set
  - target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: '{{ trigger.to_state.attributes.android.text }}

        '
    action: tts.speak
  mode: single
- id: '1767164503089'
  alias: TTS – Speak Google Voice last notification (title + text) - 9
  description: Speak Google Voice notifications via TTS on amp_1
  triggers:
  - entity_id: sensor.lm_q710_fgn_last_notification
    trigger: state
  conditions:
  - condition: template
    value_template: '{{ state_attr(''sensor.lm_q710_fgn_last_notification'',''package'')
      == ''com.google.android.apps.googlevoice'' }}'
  - condition: template
    value_template: "{{\n  (state_attr('sensor.lm_q710_fgn_last_notification','android.title')
      or '')|string|length > 0\n  or\n  (state_attr('sensor.lm_q710_fgn_last_notification','android.text')
      or '')|string|length > 0\n}}"
  - condition: template
    value_template: "{{\n  (state_attr('sensor.lm_q710_fgn_last_notification','post_time')
      | string)\n  !=\n  (state_attr('sensor.lm_q710_fgn_last_notification','post_time_last_spoken')
      | string)\n}}"
  actions:
  - variables:
      n: sensor.lm_q710_fgn_last_notification
      who: '{{ (state_attr(n,''android.title'') or ''Message'') | string }}'
      txt: '{{ (state_attr(n,''android.text'') or '''') | string }}'
      msg: '{{ (who ~ '': '' ~ txt) if txt|length > 0 else (who ~ '': (no text)'')
        }}'
      pt: '{{ (state_attr(n,''post_time'') or now().timestamp()|int) }}'
  - target:
      entity_id: tts.google_translate_en_com
    data:
      media_player_entity_id: media_player.amp_1
      message: '{{ msg }}'
    action: tts.speak
  - target:
      entity_id: input_text.last_google_voice_post_time_spoken
    data:
      value: '{{ pt }}'
    action: input_text.set_value
  mode: single
